<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Amostra - Itens para Troca</title>
    <style>
        /* Estilos CSS simples para o layout */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        #items-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }
        .item-card {
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.2s;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .item-card:hover {
            transform: translateY(-5px);
        }
        .item-card img {
            max-width: 100%;
            height: 150px;
            object-fit: contain;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .item-card h3 {
            font-size: 1.1em;
            margin: 10px 0;
            height: 3em;
            overflow: hidden;
            flex-grow: 1;
        }
        .trade-info {
            font-size: 0.95em;
            color: #27ae60; /* Cor verde para a informação de troca */
            font-weight: bold;
            margin: 10px 0;
        }
        .item-card button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin-bottom: 10px;
        }
        .item-card button:hover {
            background-color: #2980b9;
        }
        .trocador-name { /* Novo nome da classe para Trocador */
            font-size: 0.9em;
            color: #777;
        }
        .card-footer {
            margin-top: auto;
            padding-top: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Catálogo de Amostra - Itens para Troca</h1>
    
    <div id="items-container">
        <p>Carregando itens para troca...</p>
    </div>
    
</div>

<script>
    const itemsContainer = document.getElementById('items-container');
    
    // URLs das APIs Falsas para dados de amostra
    const FAKE_PRODUCTS_URL = 'https://fakestoreapi.com/products?limit=10';
    const FAKE_USERS_URL = 'https://fakestoreapi.com/users?limit=5';

    // Tipos de itens que os trocadores desejam em troca (Falso)
    const desiredTrades = [
        "Livros Raros", 
        "Câmera DSLR", 
        "Consoles de Videogame", 
        "Equipamentos de Camping", 
        "Instrumentos Musicais"
    ];

    // Função para buscar e mapear os usuários
    async function fetchUsers() {
        try {
            const response = await fetch(FAKE_USERS_URL);
            
            if (!response.ok) {
                throw new Error(`Erro HTTP ao buscar usuários! Status: ${response.status}`);
            }
            
            const users = await response.json();
            
            // Mapeia os IDs dos usuários para seus nomes completos
            const userMap = {};
            users.forEach(user => {
                userMap[user.id] = `${user.name.firstname} ${user.name.lastname}`;
            });
            return userMap;

        } catch (error) {
            console.error('Erro ao buscar usuários:', error);
            return {};
        }
    }

    // Função para buscar e exibir os produtos falsos
    async function fetchProducts() {
        // 1. Obtém o mapa de usuários
        const userMap = await fetchUsers();

        try {
            const response = await fetch(FAKE_PRODUCTS_URL);
            
            if (!response.ok) {
                throw new Error(`Erro HTTP ao buscar produtos! Status: ${response.status}`);
            }
            
            const products = await response.json();
            
            itemsContainer.innerHTML = ''; // Limpa a mensagem de carregamento
            
            const availableUserIds = Object.keys(userMap);
            
            products.forEach((product, index) => {
                const card = document.createElement('div');
                card.className = 'item-card';
                
                // --- Lógica do Trocador (Usuário Fantasma) ---
                // Associa um usuário ciclicamente
                const randomUserId = availableUserIds[index % availableUserIds.length]; 
                const trocadorName = userMap[randomUserId] || 'Trocador Desconhecido';
                
                // --- Lógica do Item Desejado ---
                // Associa um tipo de troca desejado ciclicamente
                const desiredTrade = desiredTrades[index % desiredTrades.length];


                // Cria o elemento do cartão de item
                card.innerHTML = `
                    <img src="${product.image}" alt="${product.title}">
                    <h3>${product.title}</h3>
                    
                    <p class="trade-info">Busca em troca: <strong>${desiredTrade}</strong></p>
                    
                    <div class="card-footer">
                        <button onclick="alert('Iniciando troca para o item ${product.id} (Fictício)!')">Propor Troca</button>
                        
                        <p class="trocador-name">Trocador: ${trocadorName}</p>
                    </div>
                `;
                
                itemsContainer.appendChild(card);
            });
        } catch (error) {
            console.error('Erro ao buscar produtos:', error);
            itemsContainer.innerHTML = '<p>Erro ao carregar os itens de amostra. Tente novamente mais tarde.</p>';
        }
    }

    // Chama a função para carregar os produtos
    fetchProducts();
</script>
</body>
</html>